
var _ = require('lodash');
var debug = require('debug')('lib:company');
var Promise = require('bluebird');

var fs = require('./fs');
var tld = require('./tld');
var utlutils = require('./urlutils');

var companyMap = null;
var companySource = {
 "2leep·com": ["2leep.com"],
 "33Across": ["33across.com", "tynt.com"],
 "4INFO": ["4info.com", "adhaven.com"],
 "4w MarketPlace": ["4wnet.com"],
 "63 Squares": ["63squares.com", "i-stats.com"],
 "AD Europe": ["adeurope.com"],
 "AD2ONE": ["ad2onegroup.com"],
 "ADITION": ["adition.com"],
 "ADP Dealer Services": ["cobalt.com",
                          "admission.net",
                          "adpdealerservices.com"],
 "ADSTargeting": ["adstargeting.net", "adstargeting.com"],
 "ADTECH": ["adtech.com", "adtech.de", "adtechus.com"],
 "ADTELLIGENCE": ["adtelligence.de"],
 "ADThink": ["audienceinsights.net", 
              "adthink-media.com", 
              "advertstream.com", 
              "think-about.fr"],
 "ADZ": ["adzcentral.com"],
 "AERIFY MEDIA": ["aerifymedia.com", "anonymous-media.com"],
 "AK": ["aggregateknowledge.com", "agkn.com"],
 "AKQA": ["srtk.net", "akqa.com"],
 "AMM": ["ammadv.it"],
 "AOL": ["aim.com",
          "homesessive.com",
          "spinner.com",
          "mandatory.com",
          "huffingtonpost.com",
          "aolanswers.com",
          "adsonar.com",
          "5min.com",
          "cambio.com",
          "autoblog.com",
          "moviefone.com",
          "pawnation.com",
          "theboombox.com",
          "winamp.com",
          "theboot.com",
          "aol.com",
          "noisecreep.com",
          "shortcuts.com",
          "aolcdn.com",
          "engadget.com",
          "stylemepretty.com",
          "makers.com",
          "editions.com",
          "userplane.com",
          "mapquest.com",
          "leadback.com",
          "joystiq.com",
          "shoutcast.com",
          "dailyfinance.com",
          "tacoda.net",
          "surphace.com",
          "atwola.com",
          "advertising.com",
          "games.com",
          "stylelist.com",
          "tuaw.com",
          "aoltechguru.com",
          "techcrunch.com",
          "adap.tv",
          "nexage.com",
          "kitchendaily.com",
          "patch.com"],
 "APIgurus": ["apigurus.com"],
 "AT Internet": ["hit-parade.com", "xiti.com", "atinternet.com"],
 "AT&T": ["att.com", "yp.com"],
 "AUTOCENTRE·UA": ["am.ua", "autocentre.ua"],
 "AWeber": ["aweber.com"],
 "Abax Interactive": ["abaxinteractive.com"],
 "Accelia": ["accelia.net", "durasite.net"],
 "Accordant Media": ["accordantmedia.com"],
 "Acquisio": ["clickequations.net", "acquisio.com"],
 "Act-On": ["actonsoftware.com", "act-on.com"],
 "Actisens": ["actisens.com", "gestionpub.com"],
 "ActivEngage": ["activengage.com"],
 "ActiveConversion": ["activemeter.com", "activeconversion.com"],
 "Acuity": ["acuity.com", "acuityplatform.com", "acuityads.com"],
 "Acxiom": ["mm7.net", "acxiom.com"],
 "Ad Decisive": ["a2dfp.net", "addecisive.com"],
 "Ad Dynamo": ["addynamo.com", "addynamo.net"],
 "Ad Knife": ["adknife.com"],
 "Ad Magnet": ["admagnet.com", "admagnet.net"],
 "Ad4Game": ["ad4game.com"],
 "AdCirrus": ["adcirrus.com"],
 "AdEngage": ["adengage.com"],
 "AdExtent": ["adextent.com"],
 "AdF·ly": ["adf.ly"],
 "AdFox": ["adfox.ru"],
 "AdFrontiers": ["adfrontiers.com"],
 "AdGent Digital": ["shorttailmedia.com", "adgentdigital.com"],
 "AdGibbon": ["adgibbon.com"],
 "AdIQuity": ["adiquity.com"],
 "AdInsight": ["adinsight.com", "adinsight.eu"],
 "AdJug": ["adjug.com"],
 "AdJuggler": ["adjuggler.net", "adjuggler.com"],
 "AdKeeper": ["adkeeper.com", "akncdn.com"],
 "AdLantis": ["adimg.net", "adlantis.jp"],
 "AdMarvel": ["admarvel.com"],
 "AdMaximizer Network": ["admaximizer.com"],
 "AdMedia": ["admedia.com"],
 "AdNetwork·net": ["adnetwork.net"],
 "AdOcean": ["adocean.pl", "adocean-global.com"],
 "AdOn Network": ["dashboardad.net"],
 "AdOnion": ["adonion.com"],
 "AdPerfect": ["adperfect.com"],
 "AdPredictive": ["adpredictive.com"],
 "AdReactor": ["adreactor.com"],
 "AdReady": ["adready.com", "adreadytractions.com"],
 "AdRevolution": ["adrevolution.com"],
 "AdRiver": ["adriver.ru"],
 "AdRoll": ["adroll.com"],
 "AdSafe Media": ["adsafemedia.com", "adsafeprotected.com"],
 "AdServerPub": ["adserverpub.com"],
 "AdShuffle": ["adshuffle.com"],
 "AdSide": ["adside.com", "doclix.com"],
 "AdSpeed": ["adspeed.net", "adspeed.com"],
 "AdSpirit": ["adspirit.net", "adspirit.com", "adspirit.de"],
 "AdTiger": ["adtiger.de"],
 "AdTruth": ["adtruth.com"],
 "AdXpansion": ["adxpansion.com"],
 "AdaptiveAds": ["adaptiveads.com"],
 "Adaptly": ["adaptly.com"],
 "Adara Media": ["opinmind.com", "adaramedia.com", "yieldoptimizer.com"],
 "Adatus": ["adatus.com"],
 "Adchemy": ["adchemy.com"],
 "Adconion": ["amgdgt.com",
               "adconion.com",
               "smartclip.com",
               "euroclick.com"],
 "AddFreeStats": ["3dstats.com", "addfreestats.com"],
 "AddThis": ["xgraph.net",
              "addthis.com",
              "connectedads.net",
              "addthisedge.com",
              "addthiscdn.com",
              "clearspring.com",
              "xgraph.com"],
 "Addvantage Media": ["addvantagemedia.com"],
 "Adex": ["theadex.com"],
 "Adfonic": ["adfonic.com"],
 "Adform": ["adform.net", "adform.com"],
 "Adfunky": ["adfunkyserver.com", "adfunky.com"],
 "Adfusion": ["adfusion.com"],
 "Adiant": ["adiant.com", "adblade.com"],
 "Adknowledge": ["cubics.com",
                  "adparlor.com",
                  "bidsystem.com",
                  "lookery.com",
                  "adknowledge.com"],
 "Adlibrium": ["adlibrium.com"],
 "WideOrbit": ["admeta.com", "atemda.com"],
 "Admicro": ["vcmedia.vn", "admicro.vn"],
 "Admotion": ["nspmotion.com", "admotion.com"],
 "Adnetik": ["adnetik.com", "wtp101.com"],
 "Adobe": ["auditude.com",
            "everestjs.net",
            "adobe.com",
            "typekit.com",
            "typekit.net",
            "everestads.net",
            "demdex.com",
            "demdex.net",
            "touchclarity.com",
            "2o7.net",
            "hitbox.com",
            "omtrdc.net",
            "efrontier.com",
            "omniture.com",
            "dmtracker.com",
            "everesttech.net"],
 "Adometry": ["adometry.com", "dmtry.com"],
 "Adorika": ["clickotmedia.com"],
 "Adperium": ["adperium.com"],
 "Adpersia": ["adpersia.com"],
 "AdsTours": ["clickintext.net", "adstours.com"],
 "Adtegrity.com": ["adtegrity.com", "adtegrity.net"],
 "Adult AdWorld": ["adultadworld.com"],
 "Adultmoda": ["adultmoda.com"],
 "Adverline": ["adverline.com", "adnext.fr"],
 "Advert Stream": ["advertstream.com"],
 "Advertise·com": ["advertise.com"],
 "AdvertiseSpace": ["advertisespace.com"],
 "Adzerk": ["adzerk.com", "adzerk.net"],
 "Aegis Group": ["bluestreak.com", "aemedia.com"],
 "Affectv": ["affectv.co.uk"],
 "Affine": ["affine.tv", "affinesystems.com"],
 "AfterDownload": ["afdads.com", "afterdownload.com"],
 "Airpush": ["airpush.com"],
 "Akamai": ["akamai.com", "abmr.net", "edgesuite.net", "imiclk.com"],
 "Amadesa": ["amadesa.com"],
 // "Amazon AWS": ["amazonaws.com"],
 "Amazon": [ "assoc-amazon.com",
                 "amazon-adsystem.com",
                 "cloudfront.net",
                 "images-amazon.com",
                 "alexametrics.com",
                 "amazon.co.uk",
                 "alexa.com",
                 "amazon."],
 "Ambient Digital": ["adnetwork.vn", "ambientdigital.com.vn"],
 "Amobee": ["amobee.com"],
 "AppNexus": ["appnexus.com", "adnxs.com", "adlantic.nl", "adrdgt.com"],
 "Appenda": ["appenda.com"],
 "Apple": ["apple.com"],
 "Apartena": [ "bdi-services.de", "apartena.net"],
 "Applifier": ["applifier.com"],
 "Arkwrights Homebrew": ["ctasnet.com", "arkwrightshomebrew.com"],
 "Atoomic.com": ["atoomic.com"],
 "Atrinsic": ["atrinsic.com"],
 "Attracta": ["attracta.com"],
 "Audience Ad Network": ["audienceadnetwork.com"],
 "Audience2Media": ["audience2media.com"],
 "AudienceScience": ["targetingmarketplace.com",
                      "revsci.net",
                      "audiencescience.com",
                      "wunderloop.net"],
 "Augme": ["augme.com", "hipcricket.com"],
 "Automattic": ["automattic.com",
                 "gravatar.com",
                 "intensedebate.com",
                 "polldaddy.com"],
 "Avalanchers": ["avalanchers.com"],
 "AvantLink": ["avantlink.com"],
 "Awio": ["w3roi.com", "w3counter.com", "awio.com"],
 "BLOOM Digital Platforms": ["bloom-hq.com", "adgear.com"],
 "BTBuckets": ["btbuckets.com"],
 "BV! MEDIA": ["networldmedia.net",
                "buzzcity.com",
                "bvmedia.ca",
                "networldmedia.com"],
 "BackBeat Media": ["backbeatmedia.com"],
 "Bannerconnect": ["bannerconnect.net"],
 "Banzai": ["banzaiadv.it", "stbm.it"],
 "Barilliance": ["barilliance.com"],
 "BaronsNetworks": ["baronsoffers.com"],
 "Batanga Network": ["batanganetwork.com", "batanga.com"],
 "Baycloud Systems": ["cookieq.com"],
 "Baynote": ["baynote.net", "baynote.com"],
 "Bazaarvoice": ["bazaarvoice.com"],
 "Beanstock Media": ["beanstockmedia.com"],
 "Begun": ["begun.ru"],
 "Belstat": ["belstat."],
 "Bet:lag": ["betflag.com"],
 "Betgenius": ["betgenius.com", "connextra.com"],
 "BidVertiser": ["bidvertiser.com"],
 "Bidswitch": ["bidswitch.net", "bidswitch.com"],
 "BigDoor": ["onetruefan.com", "bigdoor.com"],
 "BinLayer": ["binlayer.com"],
 "Bitcoin Plus": ["bitcoinplus.com"],
 "BittAds": ["bittads.com"],
 "Bizo": ["bizo.com", "bizographics.com"],
 "Black Label Ads": ["blacklabelads.com"],
 "BlogCatalog": ["blogcatalog.com"],
 "BlogCounter·com": ["blogcounter.de"],
 "BlogFrog": ["theblogfrog.com"],
 "BlogHer": ["blogherads.com", "blogher.com"],
 "BlogRollr": ["blogrollr.com"],
 "BloomReach": ["brcdn.com", "bloomreach.com", "brsrvr.com"],
 "Blu Trumpet": ["blutrumpet.com"],
 "BlueCava": ["bluecava.com"],
 "BlueKai": ["bkrtx.com", "tracksimple.com", "bluekai.com"],
 "Bluemetrix": ["bmmetrix.com", "bluemetrix.com"],
 "Bombora": ["ml314.com", "dinclinx.com", "madisonlogic.com"],
 "Brainient": ["brainient.com"],
 "Brand Affinity Technologies": ["brandaffinity.net"],
 "Brand·net": ["brand.net"],
 "Brandscreen": ["brandscreen.com", "rtbidder.net"],
 "Branica": ["branica.com"],
 "BrightEdge": ["brightedge.com"],
 "BrightRoll": ["btrll.com", "brightroll.com"],
 "BrightTag": ["brighttag.com", "btstatic.com", "thebrighttag.com"],
 "Brightcove": ["brightcove.com"],
 "Brilig": ["brilig.com"],
 "Browser-Update·org": ["browser-update.org"],
 "Bubblestat": ["bubblestat.com"],
 "Buffer": ["bufferapp.com"],
 "Bunchball": ["bunchball.com"],
 "Burst Media": ["burstmedia.com",
                  "burstbeacon.com",
                  "giantrealm.com",
                  "burstnet.com",
                  "burstdirectads.com"],
 "Burstly": ["burstly.com"],
 "BusinessOnline": ["businessol.com"],
 "BuySellAds": ["buysellads.com", "beaconads.com"],
 "Buysight": ["pulsemgr.com", "buysight.com", "permuto.com"],
 "BuzzFeed": ["buzzfed.com", "buzzfeed.com"],
 "BuzzParadise": ["buzzparadise.com"],
 "C3 Metrics": ["attributionmodel.com", "c3tag.com", "c3metrics.com"],
 "CAPITALDATA": ["capitaldata.fr"],
 "CBS Interactive": ["com.com", "cbsinteractive.com"],
 "CBproADS": ["cbproads.com"],
 "CNZZ": ["cnzz.com"],
 "CONTAXE": ["contaxe.com"],
 "CONTEXTWEB": ["contextweb.com"],
 "CONTEXTin": ["admailtiser.com", "contextin.com"],
 "CPMStar": ["cpmstar.com"],
 "CPX Interactive": ["cpxadroit.com", "cpxinteractive.com"],
 "CacheFly": [ "cachefly.net", "cachegly.com" ],
 "Cadreon": ["cadreon.com"],
 "CampaignGrid": ["campaigngrid.com"],
 "Caraytech": ["caraytech.com.ar", "e-planning.net"],
 "Cart·ro": ["statistics.ro", "cart.ro"],
 "CarrierZone": ["carrierzone.com"],
 "Casale Media": ["casalemedia.com", "medianet.com"],
 "Causes": ["causes.com"],
 "Cbox": ["cbox.ws"],
 "Cedexis": ["cedexis.net", "cedexis.com", "cedexis-radar.net"],
 "Certona": ["certona.com", "res-x.com"],
 "Chango": ["chango.com", "chango.ca"],
 "Channel Intelligence": ["channelintelligence.com"],
 "ChannelAdvisor": ["searchmarketing.com", "channeladvisor.com"],
 "Chartbeat": ["chartbeat.net", "chartbeat.com"],
 "Chartboost": ["chartboost.com"],
 "CheckM8": ["checkm8.com"],
 "Chitika": ["chitika.net", "chitika.com"],
 "ChoiceStream": ["choicestream.com"],
 "ClearSaleing": ["csdata3.com",
                   "clearsaleing.com",
                   "csdata1.com",
                   "csdata2.com"],
 "ClearSight Interactive": ["csi-tracking.com",
                             "clearsightinteractive.com"],
 "Clearsearch Media": ["csm-secure.com", "clearsearchmedia.com"],
 "ClicManager": ["clicmanager.fr"],
 "ClickAider": ["clickaider.com"],
 "ClickDimensions": ["clickdimensions.com"],
 "ClickDistrict": ["creative-serving.com", "clickdistrict.com"],
 "ClickFuel": ["conversiondashboard.com"],
 "ClickInc": ["clickinc.com"],
 "ClickTale": ["pantherssl.com", "clicktale.com", "clicktale.net"],
 "Clickdensity": ["clickdensity.com"],
 "Clicksor": ["clicksor.net", "clicksor.com"],
 "Clickwinks": ["clickwinks.com"],
 "ClipSyndicate": ["clipsyndicate.com"],
 "ClixMetrix": ["clixmetrix.com"],
 "Clixpy": ["clixpy.com"],
 "ClockLink": ["clocklink.com"],
 "Cloudflare": ["cloudflare.com"],
 "Clove Network": ["clovenetwork.com"],
 "ClustrMaps": ["clustrmaps.com"],
 "Cognitive Match": ["cognitivematch.com",
                      "cmmeglobal.com",
                      "cmadsasia.com",
                      "cmadseu.com",
                      "cmads.com.tw"],
 "Collarity": ["collarity.com"],
 "Collective": ["collective.com",
                 "oggifinogi.com",
                 "collective-media.net",
                 "tumri.com",
                 "yt1187.net",
                 "tumri.net"],
 "Commission Junction": ["cj.com",
                          "kcdwa.com",
                          "qksz.com",
                          "yceml.net",
                          "apmebf.com",
                          "ftjcfx.com",
                          "tqlkg.com",
                          "awltovhc.com",
                          "qksz.net"],
 "Communicator Corp": ["communicatorcorp.com"],
 "Compass Labs": ["compasslabs.com"],
 "Complex Media": ["complexmedianetwork.com", "complex.com"],
 "Compuware": ["gomez.com", "axf8.net", "compuware.com"],
 "Condè Nast": ["adobedtm.com", "condenastdigital.com", "condenast.co.uk"],
 "Conduit": ["conduit.com",
              "conduit-services.com",
              "wibiya.com",
              "conduit-banners.com"],
 "Congoo": ["congoo.com"],
 "Connexity": ["connexity.com"],
 "Consilium Media": ["consiliummedia.com"],
 "Contact At Once!": ["contactatonce.com"],
 "ContextuAds": ["contextuads.com", "agencytradingdesk.net"],
 "ConvergeDirect": ["convergetrack.com", "convergedirect.com"],
 "ConversionRuler": ["conversionruler.com"],
 "Conversive": ["conversive.nl"],
 "Convert Insights": ["convert.com", "reedge.com"],
 "Convertro": ["convertro.com"],
 "Conviva": ["conviva.com"],
 "CoreMotives": ["coremotives.com"],
 "Cox Digital Solutions": ["coxdigitalsolutions.com",
                            "afy11.net",
                            "adify.com"],
 "Crazy Egg": ["cetrk.com", "crazyegg.com"],
 "Creafi": ["creafi.com"],
 "Crimtan": ["crimtan.com"],
 "Crisp Media": ["crispmedia.com"],
 "Criteo": ["criteo.net", "criteo.com"],
 "Cross Pixel": ["crsspxl.com", "crosspixel.net", "crosspixelmedia.com"],
 "Crowd Science": ["crowdscience.com"],
 "Cyberplex": ["cyberplex.com"],
 "Cybot ": ["cookiebot.com"],
 "DC Storm": ["stormiq.com", "dc-storm.com"],
 "DG": ["eyewonder.com",
         "mdadx.com",
         "eyeblaster.com",
         "dgit.com",
         "unicast.com",
         "serving-sys.com"],
 "DS-IQ": ["ds-iq.com"],
 "DSNR Group": ["dsnrgroup.com",
                 "z5x.com",
                 "traffiliate.com",
                 "z5x.net",
                 "dsnrmg.com"],
 "Dada": ["simply.com", "dada.pro"],
 "DailyMe": ["dailyme.com", "newstogram.com"],
 "DataSift": ["tweetmeme.com", "datasift.com"],
 "DataXu": ["mexad.com", "w55c.net", "dataxu.com", "dataxu.net"],
 "Dataium": ["dataium.com", "collserve.com"],
 "Datalogix": ["nexac.com", "nextaction.net"],
 "Datonics": ["datonics.com", "pro-market.net"],
 "Datran Media": ["datranmedia.com", "displaymarketplace.com"],
 "Datvantage": ["datvantage.com"],
 "Dedicated Media": ["dedicatednetworks.com", "dedicatedmedia.com"],
 "Delivr": ["delivr.com", "percentmobile.com"],
 "Delta Projects": ["deltaprojects.se", "adaction.se", "de17a.com"],
 "Demand Media": ["demandmedia.com", "indieclick.com"],
 "Demandbase": ["demandbase.com"],
 "Deutsche Post DHL": ["dp-dhl.com", "adcloud.com", "adcloud.net"],
 "Developer Media": ["lqcdn.com", "developermedia.com"],
 "Didit": ["didit.com", "did-it.com"],
 "Digg": ["digg.com"],
 "Digital River": ["netflame.cc", "digitalriver.com", "keywordmax.com"],
 "Digital Window": ["digitalwindow.com", "perfiliate.com"],
 "Digitize": ["digitize.ie"],
 "Direct Response Group": ["directresponsegroup.com", "ppctracking.net"],
 "DirectCORP": ["ipcounter.de"],
 "Disqus": ["disquscdn.com", "disqus.com"],
 "Dot & Ads": ["dotandad.com" ],
 "DoublePimp": ["doublepimp.com"],
 "DoublePositive": ["bid-tag.com", "doublepositive.com"],
 "DoubleVerify": ["doubleverify.com"],
 "Drawbridge": ["drawbrid.ge", "adsymptotic.com"],
 "DynamicOxygen": ["exitjunction.com", "dynamicoxygen.com"],
 "EQ Ads": ["eqads.com"],
 "ESVdigital": ["esearchvision.com"],
 "EXTENSIONS·RU": ["extensions.ru"],
 "Echo": ["aboutecho.com", "js-kit.com", "haloscan.com"],
 "Effective Measure": ["effectivemeasure.net", "effectivemeasure.com"],
 "Elasticad": ["elasticad.net", "elasticad.com"],
 "Eloqua": ["eloqua.com"],
 "Elemedia": ["gelestatic.it"],
 "Emediate": ["emediate.com"],
 "Emego": ["usemax.de"],
 "Encore": ["sitecompass.com", "encoremetrics.com"],
 "Enecto": ["enecto.com"],
 "Engago Technology": ["engago.com", "appmetrx.com"],
 "Ensighten": ["ensighten.com"],
 "Entireweb": ["entireweb.com"],
 "Epic Media Group": ["epicmobileads.com",
                       "epicadvertising.com",
                       "trafficmp.com",
                       "theepicmediagroup.com",
                       "epicmarketplace.com"],
 "Epsilon": ["epsilon.com"],
 "EroAdvertising": ["ero-advertising.com"],
 "Etineria": ["etineria.com", "adwitserver.com"],
 "Eulerian Technologies": ["eulerian.com", "eulerian.net"],
 "Everyday Health": ["waterfrontmedia.com", "everydayhealth.com"],
 "Evidon": ["betrad.com", "evidon.com"],
 "Evisions Marketing": ["evisionsmarketing.com", "engineseeker.com"],
 "Evolve": ["evolvemediametrics.com",
             "evolvemediacorp.com",
             "gorillanation.com"],
 "ExoClick": ["exoclick.com"],
 "Experian": ["experian.com", "pricegrabber.com", "audienceiq.com"],
 "Exponential Interactive": ["exponential.com",
                              "fulltango.com",
                              "tribalfusion.com",
                              "adotube.com"],
 "Extension Factory": ["extensionfactory.com"],
 "Eyeconomy": ["eyeconomy.com", "eyeconomy.co.uk", "sublimemedia.net"],
 "Eyeviewdigital": ["eyeviewdigital.com", "eyeviewads.com"],
 "Fabbricadigitale": ["fdnames.com"],
 "Facebook": ["facebook.",
               "akamaihd.net",
               "friendfeed.com",
               "fbcdn.net",
               "facebookofsex.com",
               "instagram.com",
               "fb.com"],
 "Facilitate Digital": ["facilitatedigital.com",
                         "adsfac."],
 "Fairfax Media": ["fxj.com.au", "fairfax.com.au"],
 "Fastly": [ "fastly.net" ],
 "Fathom": ["fathomdelivers.com", "fathomseo.com"],
 "Federated Media": ["fmpub.net", "lijit.com", "federatedmedia.net"],
 "Feedjit": ["feedjit.com"],
 "FetchBack": ["fetchback.com"],
 "Fiksu": ["fiksu.com"],
 "FinancialContent": ["financialcontent.com"],
 "Fizz-Buzz Media": ["fizzbuzzmedia.net", "fizzbuzzmedia.com"],
 "Flashtalking": ["flashtalking.com"],
 "Flattr": ["flattr.com"],
 "Flite": ["flite.com", "widgetserver.com"],
 "Flurry": ["flurry.com"],
 "Flytxt": ["flytxt.com"],
 "Footprint": ["footprintlive.com"],
 "Forbes": ["brandsideplatform.com", "forbes.com"],
 "Fox One Stop Media": ["foxnetworks.com",
                         "myads.com",
                         "mobsmith.com",
                         "fimserve.com",
                         "foxonestop.com",
                         "othersonline.com",
                         "rubiconproject.com"],
 "FreakOut": ["fout.jp"],
 "Free Online Users": ["freeonlineusers.com"],
 "Free-PageRank·com": ["free-pagerank.com"],
 "FreeWheel": ["fwmrm.net", "freewheel.tv"],
 "Freedom Communications": ["freedom.com"],
 "FriendFinder Networks": ["pop6.com", "ffn.com", "adultfriendfinder.com"],
 "Frog Sex": ["double-check.com", "frogsex.com"],
 "Future Ads": ["futureads.com", "resultlinks.com"],
 "GB-World": ["gb-world.net"],
 "GENIE GROUP": ["geniegroupltd.co.uk"],
 "GISMAds": ["gismads.jp"],
 "GSI Commerce": ["pntra.com",
                   "pjatr.com",
                   "pepperjam.com",
                   "pntrs.com",
                   "gsicommerce.com",
                   "pjtra.com",
                   "gsimedia.net",
                   "pntrac.com"],
 "GTop": ["gtopstats.com", "gtop.ro"],
 "Game Advertising Online": ["game-advertising-online.com"],
 "Games2win": ["inviziads.com", "games2win.com"],
 "Gamned": ["gamned.com"],
 "Gator·IO": ["gator.io" ],
 "Gannett": ["gannett.com", "pointroll.com"],
 "Gemius": ["gemius.com", "gemius.pl"],
 "Genius·com": ["genius.com", "rsvpgenius.com"],
 "GeoAds": ["geoads.com"],
 "Altruja": ["altruja."],
 "Get Satisfaction": ["getsatisfaction.com"],
 "GetGlue": ["getglue.com", "smrtlnks.com"],
 "GfK Group": ["gfkdaphne.com", "gfk.com", "daphnecm.com"],
 "Gigya": ["gigcount.com", "gigya.com"],
 "GitHub": ["gaug.es"],
 "Glam Media": ["glam.com", "glammedia.com"],
 "Global Takeoff": ["globaltakeoff.com", "globaltakeoff.net"],
 "Globe7": ["globe7.com"],
 "Go Daddy": ["trafficfacts.com", "godaddy.com" ],
 "jQuery CDN": [ "jquery.com"],
 "Higher One": [ "campuslabs.com "],
 "IFlyChat": [ "iflychat.com" ],
 "GoDataFeed": ["godatafeed.com"],
 "GoGrid": ["gogrid.com", "formalyzer.com", "komli.net"],
 "GoSquared": ["gosquared.com"],
 "GoStats": ["gostats.com"],
 "GoldSpot Media": ["goldspotmedia.com"],
 "Google": ["admob.com",
             "orkut.com",
             "2mdn.net",
             "googleartproject.com",
             "destinationurl.com",
             "gstatic.com",
             "googletagmanager.com",
             "postrank.com",
             "google-melange.com",
             "youtube.com",
             "youtube-nocookie.com",
             "smtad.net",
             "googletagservices.com",
             "googleadservices.com",
             "googlecode.com",
             "doubleclick.net",
             "googlesyndication.com",
             "ggpht.com",
             "teracent.net",
             "cc-dt.com",
             "invitemedia.com",
             "googleusercontent.com",
             "google.com",
             "apture.com",
             "teracent.com",
             "recaptcha.net",
             "panoramio.com",
             "postini.com",
             "googleapis.com",
             "feedburner.com",
             "gmodules.com",
             "ytimg.com",
             "blogblog.com",
             "blogger.com",
             "blogspot.",
             "googlemail.com",
             "google-analytics.com",
             "ytsa.net",
             "admeld.com",
             "gmail.com",
             "google.",
             "0emm.com",
             "appspot.com",
             "cloudfunctions.net",
             "codespot.com",
             "googlecode.com",
             "pagespeedmobilizer.com",
             "publishproxy.com",
             "withgoogle.com",
             "withyoutube.com" ],
 "Grapeshot": ["grapeshot.co.uk"],
 "Gravity": ["gravity.com", "grvcdn.com"],
 "Grocery Shopping Network": ["groceryshopping.net"],
 "GroovinAds": ["groovinads.com"],
 "Gruner+Jahr": ["guj.de", "ligatus.com"],
 "GumGum": ["gumgum.com"],
 "Gunggo": ["gunggo.com"],
 "HOTWords": ["hotwords.com", "hotwords.es"],
 "HP": ["optimost.com", "hp.com"],
 "HUNT Mobile Ads": ["huntmads.com"],
 "Hands Mobile": ["hands.com.br"],
 "Harrenmedia": ["harrenmedia.com", "harrenmedianetwork.com"],
 "HealthPricer": ["healthpricer.com", "adacado.com"],
 "Hearst": ["sptag1.com",
             "hearst.com",
             "icrossing.com",
             "redaril.com",
             "sptag2.com",
             "sptag.com",
             "ic-live.com",
             "raasnet.com",
             "sptag3.com",
             "iclive.com"],
 "Heyzap": ["heyzap.com"],
 "Hi-media": ["comclick.com", "hi-media.com"],
 "Histats": ["histats.com"],
 "Hit Sniffer": ["hitsniffer.com"],
 "HitsLink": ["hitslink.com"],
 "Swiftype": ["swiftype.com", "swiftypecdn.com"],
 "HookLogic": ["hlserve.com", "hooklogic.com"],
 "Horyzon Media": ["meetic-partners.com",
                    "horyzon-media.com",
                    "smartadserver.com"],
 "Httpool": ["httpool.com"],
 "HubSpot": ["hubspot.com"],
 "Hurra·com": ["hurra.com"],
 "I-Behavior": ["ib-ibi.com"],
 "I·UA": ["i.ua"],
 "IAC": ["iacadvertising.com", "iac.com"],
 "IBM": ["ibm.com", "coremetrics.com", "cmcore.com", "unica.com"],
 "IDG": ["idgtechnetwork.com", "idg.com"],
 "INFOnline": ["infonline.de", "ioam.de", "ivwbox.de"],
 "ISI Technologies": ["digbro.com", "adversalservers.com"],
 "IgnitAd": ["ignitad.com"],
 "IgnitionOne": ["ignitionone.net", "ignitionone.com", "searchignite.com"],
 "Improve Digital": ["improvedigital.com", "360yield.com"],
 "InMobi": ["sproutinc.com", "inmobi.com"],
 "InSkin Media": ["inskinmedia.com"],
 "Inadco": ["inadco.com", "anadcoads.com", "inadcoads.com"],
 "InboundWriter": ["enquisite.com", "inboundwriter.com"],
 "Infectious Media": ["infectiousmedia.com", "impressiondesk.com"],
 "Inflection Point Media": ["inflectionpointmedia.com"],
 "InfoStars": ["hotlog.ru", "infostars.ru"],
 "Infogroup": ["infogroup.com"],
 "Infolinks": ["infolinks.com"],
 "Infra-Ad": ["infra-ad.com"],
 "Innity": ["innity.com"],
 "InsightExpress": ["insightexpressai.com", "insightexpress.com"],
 "Inspectlet": ["inspectlet.com"],
 "intelliAd": ["intelliad.de"],
 "IntelligenceFocus": ["domodomain.com", "intelligencefocus.com"],
 "Intent Media": ["intentmedia.com", "intentmedia.net"],
 "Intercom": ["intercom.io"],
 "Intergi": ["intergi.com"],
 "Intermarkets": ["intermarkets.net"],
 "Intermundo Media": ["intermundomedia.com"],
 "Internet Brands": ["internetbrands.com", "ibpxl.com"],
 "Interpolls": ["interpolls.com"],
 "Inuvo": ["inuvo.com"],
 "InvestingChannel": ["investingchannel.com"],
 "Iubenda": ["iubenda.com"],
 "JWPlayer": ["jwpcdn.com", "jwpsrv.com"],
 "Jaroop": ["jaroop.com"],
 "JasperLabs": ["jasperlabs.com"],
 "Jemm": ["jemmgroup.com"],
 "Jink": ["jink.de", "jinkads.com"],
 "Jirbo": ["adcolony.com", "jirbo.com"],
 "Jivox": ["jivox.com"],
 "JobThread": ["jobthread.com"],
 "Juice adv": ["juiceadv.com"],
 "JuicyAds": ["juicyads.com"],
 "Jumptap": ["jumptap.com"],
 "KISSmetrics": ["kissmetrics.com"],
 "KIT digital": ["keewurd.com", "peerset.com", "kitd.com"],
 "Kaltura": ["kaltura.com"],
 "Kataweb": ["kataweb.it"],
 "Kenshoo": ["kenshoo.com", "xg4ken.com"],
 "KeyMetric": ["keymetric.net"],
 "Keyade": ["keyade.com"],
 "KissMyAds": ["kissmyads.com"],
 "Kitara Media": ["103092804.com", "kitaramedia.com"],
 "Kokteyl": ["kokteyl.com", "admost.com"],
 "Komli": ["komli.com"],
 "Kontera": ["kontera.com"],
 "Korrelate": ["adsummos.com", "adsummos.net", "korrelate.com"],
 "Krux": ["krux.com", "krxd.net", "kruxdigital.com"],
 "Layer-Ad·org": ["layer-ad.org"],
 "LeadBolt": ["leadbolt.com"],
 "LeadFormix": ["leadforce1.com", "leadformix.com"],
 "LeadLander": ["leadlander.com", "trackalyzer.com"],
 "Legolas Media": ["legolas-media.com"],
 "Levexis": ["levexis.com"],
 "Lexos Media": ["lexosmedia.com", "adbull.com"],
 "LifeStreet": ["lifestreetmedia.com", "lfstmedia.com"],
 "Limelight Networks": ["llnwd.net", "clickability.com", "limelight.com"],
 "LineZing": ["linezing.com"],
 "LinkConnector": ["linkconnector.com"],
 "LinkShare": ["linksynergy.com", "linkshare.com"],
 "LinkWeLove": ["linkwelove.it"],
 "LinkedIn": ["licdn.com", "linkedin.com"],
 "Linkpulse": ["lp4.io"],
 "Linkz": ["linkz.net"],
 "Listrak": ["listrak.com", "listrakbi.com"],
 "LiveIntent": ["liadm.com", "liveintent.com"],
 "LiveInternet": ["liveinternet.ru", "yadro.ru"],
 "LivePerson": ["liveperson.net", "liveperson.com", "nuconomy.com"],
 "LiveRail": ["liverail.com"],
 "Livefyre": ["livefyre.com", "fyre.co"],
 "Local Yokel Media": ["localyokelmedia.com"],
 "Lockerz": ["addtoany.com", "lockerz.com"],
 "Logdy": ["logdy.com"],
 "LongTail Video": ["longtailvideo.com", "ltassrv.com"],
 "Longboard Media": ["longboardmedia.com"],
 "Loomia": ["loomia.com"],
 "LoopFuse": ["lfov.net", "loopfuse.net"],
 "Lotame": ["crwdcntrl.net", "lotame.com"],
 "Lottomatica": ["lottomatica.it"],
 "LucidMedia": ["lucidmedia.com"],
 "Luminate": ["luminate.com", "pixazza.com"],
 "Lynchpin": ["lypn.com", "lynchpin.com"],
 "Lyris": ["lyris.com", "clicktracks.com"],
 "Lytiks": ["lytiks.com"],
 "MADS": ["madsone.com"],
 "MONETIZEdigital": ["cpalead.com"],
 "MUNDO Media": ["mundomedia.com", "silver-path.com"],
 "Madhouse": ["madhouse.cn"],
 "Magnetic": ["qjex.net", "domdex.net", "magnetic.com", "domdex.com"],
 "Magnify360": ["dialogmgr.com", "magnify360.com"],
 "Mail·Ru": ["list.ru", "mail.ru"],
 "MailChimp": ["campaign-archive1.com",
                "mailchimp.com",
                "list-manage.com"],
 "Manifest": ["bannerbank.ru", "manifest.ru"],
 "Marchex": ["industrybrains.com", "marchex.com"],
 "Marimedia": ["marimedia.net"],
 "MarketGid": ["marketgid.com", "dt00.net", "dt07.net"],
 "Marketo": ["marketo.net", "marketo.com"],
 "Markit": ["wsod.com", "markit.com"],
 "MarkMonitor": [ "hs-analytics.net "],
 "Marktest": ["marktest.com", "marktest.pt"],
 "Martini Media": ["martinimedianetwork.com", "martiniadnetwork.com"],
 "MashLogic": ["mashlogic.com"],
 "Match·com": ["chemistry.com", "match.com"],
 "Matomy": ["xtendmedia.com",
             "matomy.com",
             "matomymarket.com",
             "matomymedia.com"],
 "MaxBounty": ["maxbounty.com", "mb01.com"],
 "MaxPoint": ["mxptint.net", "maxpointinteractive.com", "maxusglobal.com"],
 "MaxCDN": ["maxcdn.com", "bootstrapcdn.com"],
 "Maxymiser": ["maxymiser.com"],
 "McAfee": ["scanalert.com", "mcafee.com"],
 "MdotM": ["mdotm.com"],
 "MediaBrix": ["mediabrix.com"],
 "MediaCom": ["mediacom.com"],
 "MediaMath": ["adroitinteractive.com",
                "mediamath.com",
                "designbloxlive.com",
                "mathtag.com"],
 "MediaShakers": ["media-servers.net", "mediashakers.com"],
 "MediaTrust": ["mediatrust.com"],
 "MediaWhiz": ["mediawhiz.com", "adnetinteractive.com"],
 "Medialets": ["medialets.com"],
 "Mediamond": ["mediamond.it"],
 "Mediaocean": ["adbuyer.com", "mediaocean.com"],
 "Medicx Media Solutions": ["medicxmedia.com"],
 "Meebo": ["meebo.com", "meebocdn.net"],
 "Meetrics": ["meetrics.net",
               "research.de.com",
               "mxcdn.net",
               "meetrics.de"],
 "MegaIndex": ["megaindex.ru"],
 "Mercent": ["mercent.com"],
 "MerchantAdvantage": ["merchantadvantage.com"],
 "Merchenta": ["merchenta.com"],
 "Meta Network": ["metanetwork.com"],
 "Meteor": ["meteorsolutions.com"],
 "MetrixLab": ["metrixlab.com", "customerconversio.com", "crm-metrix.com"],
 "MicroAd": ["microad.jp"],
 "Microsoft": ["xbox.com",
                "msn.com",
                "microsoftstore.com",
                "skype.com",
                "zune.net",
                "adecn.com",
                "bing.com",
                "adbureau.net",
                "microsoftalumni.org",
                "gamesforwindows.com",
                "getgamesmart.com",
                "officelive.com",
                "msads.net",
                "microsoftalumni.com",
                "microsoft.com",
                "s-msn.com",
                "worldwidetelescope.org",
                "ieaddons.com",
                "windowsphone.com",
                "outlook.com",
                "healthvault.com",
                "atdmt.com",
                "msnbc.com",
                "nbcnews.com",
                "msndirect.com",
                "netconversions.com",
                "aquantive.com",
                "iegallery.com",
                "zune.com",
                "office.com",
                "roiservice.com",
                "live.com"],
 "Millennial Media": ["mydas.mobi",
                       "millennialmedia.com",
                       "decktrade.com"],
 "Mindset Media": ["mmismm.com", "mindset-media.com"],
 "Mirando": ["mirando.de"],
 "Mixpanel": ["mixpanel.com"],
 "Mixpo": ["mixpo.com"],
 "MoPub": ["mopub.com"],
 "Moat": ["moatads.com", "moat.com"],
 "MobFox": ["mobfox.com"],
 "MobVision": ["admoda.com", "mobvision.com"],
 "Mobile Meteor": ["mobilemeteor.com", "showmeinn.com"],
 "Mocean Mobile": ["moceanmobile.com"],
 "Mochila": ["mochila.com"],
 "Mojiva": ["mojiva.com"],
 "Monetate": ["monetate.net", "monetate.com"],
 "Mongoose Metrics": ["mongoosemetrics.com"],
 "Monitus": ["monitus.net"],
 "Monoloop": ["monoloop.com"],
 "Monster": ["monster.com"],
 "Moolah Media": ["moolah-media.com", "moolahmedia.com"],
 "Mouseflow": ["mouseflow.com"],
 "MovieLush·com": ["affbuzzads.com", "movielush.com"],
 "Multiple Stream Media": ["adclickmedia.com", "multiplestreammktg.com"],
 "MyBuys": ["mybuys.com", "veruta.com"],
 "MyCounter": ["mycounter.com.ua"],
 "MonoType": ["myfonts.net", "fonts.com"],
 "MyPagerank·Net": ["mypagerank.net"],
 "MyWebGrocer": ["mywebgrocer.com"],
 "Médiamétrie": ["mediametrie-estat.com", "estat.com"],
 "NDN": ["newsinc.com"],
 "Nanigans": ["nanigans.com"],
 "Nativo": ["postrelease.com"],
 "Navegg": ["navegg.com", "navdmp.com"],
 "NeodataGroup": ["adagionet.com", "neodatagroup.com"],
 "Net Applications": ["hitsprocessor.com", "netapplications.com"],
 "Net-Results": ["nr7.us", "net-results.com", "cdnma.com"],
 "NetAffiliation": ["netaffiliation.com"],
 "NetBina": ["netbina.com"],
 "NetElixir": ["netelixir.com", "adelixir.com"],
 "NetSeer": ["netseer.com"],
 "NetShelter": ["netshelter.com", "netshelter.net"],
 "Netmining": ["netmining.com", "netmng.com"],
 "Neustar": ["neustar.biz", "adadvisor.net"],
 "New Relic": ["newrelic.com", "nr-data.net"],
 "NewsRight": ["apnewsregistry.com"],
 "NextPerformance": ["nxtck.com", "nextperformance.com"],
 "NextSTAT": ["nextstat.com"],
 "Nextag": ["nextag.com"],
 "Nielsen": ["imrworldwide.net",
              "imrworldwide.com",
              "glanceguide.com",
              "nielsen.com"],
 "Ninua": ["networkedblogs.com", "ninua.com"],
 "Nokta": ["virgul.com", "noktamedya.com"],
 "NowSpots": ["nowspots.com"],
 "Nuffnang": ["nuffnang.com", "nuffnang.com.my"],
 "OPT": ["advg.jp", "opt.ne.jp", "p-advg.com"],
 "Oberon Media": ["oberon-media.com", "blaze.com"],
 "Observer": ["observerapp.com"],
 "Ohana Media": ["ohana-media.com", "ohanaqb.com", "adohana.com"],
 "Olark": ["olark.com"],
 "Omnicom Group": ["omnicomgroup.com", "p-td.com", "accuenmedia.com"],
 "One iota": ["oneiota.co.uk", "itsoneiota.com"],
 "OneStat": ["onestat.com"],
 "Onetag": ["onetag.net", "onetag-sys."],
 "Oneupweb": ["sodoit.com", "oneupweb.com"],
 "Ooyala": ["oo4.com", "ooyala.com"],
 "Open New Media": ["onm.de"],
 "OpenX": ["openxenterprise.com",
            "openx.com",
            "openx.org",
            "servedbyopenx.com",
            "openx.net",
            "liftdna.com"],
 "Openstat": ["spylog.com", "openstat.ru"],
 "Opentracker": ["opentracker.net"],
 "Opera": ["opera.com", "mobiletheory.com"],
 "OptMD": ["optmd.com"],
 "Opta": ["opta.net"],
 "Optify": ["optify.net"],
 "Optimal": ["optim.al",
              "xa.net",
              "nprove.com",
              "cpmadvisors.com",
              "orbengine.com",
              "cpmatic.com"],
 "Optimizely": ["optimizely.com"],
 "OptimumResponse": ["optimumresponse.com"],
 "Oracle": ["instantservice.com",
             "atgsvcs.com",
             "istrack.com",
             "oracle.com",
             "estara.com"],
 "OrangeSoda": ["orangesoda.com", "otracking.com"],
 "Out There Media": ["out-there-media.com"],
 "Outbrain": ["sphere.com", "outbrain.com"],
 "Oversee·net": ["dsnextgen.com", "oversee.net"],
 "OwnerIQ": ["owneriq.net", "owneriq.com"],
 "OxaMedia": ["adsbwm.com", "oxamedia.com", "adconnexa.com"],
 "PLATFORM ONE": ["platform-one.co.jp"],
 "Paid-To-Promote.net": ["paid-to-promote.net"],
 "Papaya": ["papayamobile.com"],
 "Pardot": ["pardot.com"],
 "Parse·ly": ["parsely.com"],
 "PayClick": ["payclick.it"],
 "Paypal": ["paypalobjects.com", "paypal.com"],
 "PayHit": ["payhit.com"],
 "Paypopup·com": ["lzjl.com", "paypopup.com"],
 "Peer39": ["peer39.net", "peer39.com"],
 "PeerFly": ["peerfly.com"],
 "Peerius": ["peerius.com"],
 "Performancing": ["performancing.com"],
 "PersianStat·com": ["persianstat.com"],
 "Pheedo": ["pheedo.com"],
 "Phonalytics": ["phonalytics.com"],
 "PhotoBucket": ["photobucket.com"],
 "Pictela": ["pictela.com", "pictela.net"],
 "Pinterest": ["pinterest.com"],
 "Piwik": ["piwik.org"],
 "Pixel.sg": ["pixel.sg"],
 "Piximedia": ["piximedia.com"],
 "Po·st": ["po.st"],
 "PocketCents": ["pocketcents.com"],
 "Polar": ["mediavoice.com"],
 "Pontiflex": ["pontiflex.com"],
 "PopAds": ["popads.net", "popadscdn.net"],
 "PopRule": ["gocampaignlive.com", "poprule.com"],
 "Populis": ["populis.com"],
 "PrecisionClick": ["precisionclick.com"],
 "PredictAd": ["predictad.com"],
 "Pressflex": ["blogads.com", "pressflex.com"],
 "Prime Visibility": ["cptgt.com",
                       "sdfje.com",
                       "primevisibility.com",
                       "popcde.com",
                       "addlvr.com",
                       "adonnetwork.net",
                       "adtrgt.com",
                       "urtbk.com",
                       "cpvfeed.com",
                       "cpvtgt.com",
                       "adonnetwork.com",
                       "bannertgt.com",
                       "adcde.com"],
 "Proclivity": ["pswec.com",
                 "proclivitymedia.com",
                 "proclivitysystems.com"],
 "Project Wonderful": ["projectwonderful.com"],
 "Pronunciator": ["visitorville.com", "pronunciator.com"],
 "Prosperent": ["prosperent.com"],
 "Proximic": ["proxilinks.com", "proximic.com", "proximic.net"],
 "PubMatic": ["revinet.com", "pubmatic.com", "moceanads.com"],
 "TimeOne": ["publicidees.com"], // former
 "Publishers Clearing House": ["pch.com"],
 "Publy": ["publy.net"],
 "PunchTab": ["punchtab.com"],
 "QUISMA": ["iaded.com",
             "quismatch.com",
             "xmladed.com",
             "quisma.com",
             "xaded.com",
             "i-behavior.com"],
 "Qualaroo": ["qualaroo.com", "kissinsights.com"],
 "Quantcast": ["quantcast.com", "quantserve.com"],
 "QuinStreet": ["qnsr.com",
                 "thecounter.com",
                 "qsstats.com",
                 "quinstreet.com"],
 "Quintelligence": ["quintelligence.com"],
 "RCS": ["rcsadv.it", "rcsobjects.it"],
 "RIM": ["rim.com", "scoreloop.com"],
 "RMBN": ["rmbn.net", "rmbn.ru"],
 "RMM": ["rmmonline.com"],
 "RadarURL": ["radarurl.com"],
 "Radiate Media": ["matchbin.com", "radiatemedia.com"],
 "RadiumOne": ["gwallet.com", "radiumone.com"],
 "Radius Marketing": ["radiusmarketing.com"],
 "Rambler": ["rambler.ru"],
 "Rapleaf": ["rlcdn.com", "rapleaf.com", "liveramp.com"],
 "ReTargeter": ["retargeter.com"],
 "ReachLocal": ["reachlocal.com", "rlcdn.net"],
 "React2Media": ["react2media.com"],
 "Redux Media": ["reduxmedia.com"],
 "Rekko": ["convertglobal.com", "rekko.com"],
 "Reklam Store": ["reklamstore.com"],
 "Reklamport": ["reklamport.com"],
 "Reklamz": ["reklamz.com"],
 "Relevad": ["relevad.com", "relestar.com"],
 "Renegade Internet": ["advertserve.com", "renegadeinternet.com"],
 "Research Now": ["valuedopinions.co.uk", "researchnow.com"],
 "Resolution Media": ["resolutionmedia.com"],
 "Resonate": ["resonatenetworks.com", "resonateinsights.com"],
 "Responsys": ["responsys.com"],
 "Retirement Living": ["blvdstatus.com", "retirement-living.com"],
 "RevenueMax": ["revenuemax.de"],
 "Rhythm": ["rhythmnewmedia.com", "rnmd.net"],
 "RichRelevance": ["richrelevance.com"],
 "RightAction": ["rightaction.com"],
 "Rocket Fuel": ["rocketfuel.com", "rfihub.com", "rfihub.net"],
 "Rovion": ["rovion.com"],
 "Roxr": ["roxr.net", "staticstuff.net", "getclicky.com"],
 "RuTarget": ["rutarget.ru"],
 "SAS": ["aimatch.com", "sas.com"],
 "SAY": ["typepad.com", "saymedia.com", "videoegg.com"],
 "STATSIT": ["statsit.com"],
 "Sabre": ["sabrehospitality.com", "reztrack.com", "sabre.com"],
 "Safecount": ["questionmarket.com",
                "safecount.net",
                "dl-rms.com",
                "dlqm.net"],
 "SageMetrics": ["sagemetrics.com", "sageanalyst.net"],
 "Salesforce·com": ["salesforce.com"],
 "Samurai Factory": ["samurai-factory.jp", "shinobi.jp"],
 "Sapient": ["bridgetrack.com", "sapient.com"],
 "Scandinavian AdNetworks": ["scandinavianadnetworks.com"],
 "Scribble": ["scribblelive.com"],
 "ScribeFire": ["scribefire.com"],
 "Scribol": ["scribol.com"],
 "ScrollToTop": [ "scrolltotop.com" ],
 "SearchForce": ["searchforce.com", "searchforce.net"],
 "SeeVolution": ["seevolution.com", "svlu.net"],
 "Seevast": ["syndigonetworks.com",
              "pulse360.com",
              "seevast.com",
              "kanoodle.com"],
 "Segment·io": ["segment.io"],
 "Selectable Media": ["selectablemedia.com", "nabbr.com"],
 "SevenAds": ["sevenads.net"],
 "SexInYourCity": ["sexinyourcity.com"],
 "ShareASale": ["shareasale.com"],
 "ShareThis": ["sharethis.com"],
 "Shareaholic": ["shareaholic.com", "buzzster.com"],
 "SharedCounter": ["sharedcount.com"],
 "ShinyStat": ["shinystat.it", "shinystat.com"],
 "ShipStore": ["shipstore.it"],
 "Shopify": ["shopify.com"],
 "Shopzilla": ["shopzilla.com"],
 "Silktide": ["silktide.com"],
 "Silverpop": ["silverpop.com", "vtrenz.net", "mkt51.net", "pages05.net"],
 "Simpli·fi": ["simpli.fi"],
 "SiteScout": ["sitescout.com"],
 "Six Apart": ["sixapart.com"],
 "Skimlinks": ["skimresources.com", "skimlinks.com"],
 "Skribit": ["skribit.com"],
 "Skupe Net": ["adcentriconline.com", "skupenet.com"],
 "Smaato": ["smaato.com"],
 "Smiley Media": ["smileymedia.com"],
 "Smowtion": ["smowtion.com"],
 "Snap": ["snap.com"],
 "SnapEngage": ["snapengage.com"],
 "Snoobi": ["snoobi.com"],
 "SocialChorus": ["halogennetwork.com",
                   "socialchorus.com",
                   "halogenmediagroup.com"],
 "SocialInterface": ["ratevoice.com", "socialinterface.com"],
 "SocialTwist": ["socialtwist.com"],
 "Space Chimp Media": ["spacechimpmedia.com"],
 "Spark Studios": ["sparkstudios.com"],
 "Sparklit": ["adbutler.com", "sparklit.com"],
 "Specific Media": ["sitemeter.com",
                     "specificmedia.com",
                     "adviva.co.uk",
                     "adviva.net",
                     "specificclick.net"],
 "Spectate": ["spectate.com"],
 "Sponge": ["spongegroup.com"],
 "Spongecell": ["spongecell.com"],
 "SponsorAds": ["sponsorads.de"],
 "Spot200": ["spot200.com"],
 "SpotXchange": ["spotxchange.com"],
 "Spring Metrics": ["springmetrics.com"],
 "StarGames": ["stargamesaffiliate.com"],
 "StatCounter": ["statcounter.com"],
 "Statisfy": ["statisfy.net"],
 "SteelHouse": ["steelhouse.com", "steelhousemedia.com"],
 "Stratigent": ["stratigent.com"],
 "Streamray": ["cams.com", "streamray.com"],
 "StrikeAd": ["strikead.com"],
 "StrongMail": ["popularmedia.com"],
 "Struq": ["struq.com"],
 "StumbleUpon": ["stumble-upon.com", "stumbleupon.com"],
 "Suite 66": ["suite66.com"],
 "Summit": ["summitmedia.co.uk"],
 "Superfish": ["superfish.com"],
 "SupersonicAds": ["supersonicads.com"],
 "Switch": ["switchconcepts.com",
             "switchadhub.com",
             "switchconcepts.co.uk"],
 "Swoop": ["swoop.com"],
 "SymphonyAM": ["factortg.com"],
 "Synacor": ["synacor.com"],
 "Syncapse": ["syncapse.com", "clickable.net"],
 "TENSQUARE": ["tensquare.com"],
 "TLVMedia": ["tlvmedia.com"],
 "TNS": ["sesamestats.com",
          "statistik-gallup.net",
          "tns-counter.ru",
          "tns-cs.net",
          "tnsglobal.com"],
 "TRUSTe": ["truste.com"],
 "Taboola": ["taboola.com"],
 "Tailsweep": ["tailsweep.com"],
 "Tap·me": ["tap.me"],
 "TapIt!": ["tapit.com"],
 "Tapad": ["tapad.com"],
 "Tapgage": ["tapgage.com", "bizmey.com"],
 "Targetix": ["targetix.net"],
 "Tatto Media": ["quicknoodles.com", "tattomedia.com"],
 "Teadma": ["teadma.com"],
 "Teads": ["ebz.io"],
 "Technorati": ["technorati.com", "technoratimedia.com"],
 "TellApart": ["tellapt.com", "tellapart.com"],
 "Crafted": ["crafted.tm"],
 "Telstra": ["sensis.com.au",
              "sensisdata.com.au",
              "telstra.com.au",
              "sensisdigitalmedia.com.au"],
 "Terra": ["terra.com.br", "eztargetmedia.com"],
 "The Heron Partnership": ["marinsm.com", "heronpartners.com.au"],
 "The Numa Group": ["thenumagroup.com", "hittail.com"],
 "The Rimm-Kaufman Group": ["rimmkaufman.com", "rkdms.com"],
 "The Search Agency": ["thesearchagency.com", "thesearchagency.net"],
 "The Trade Desk": ["adsrvr.org", "thetradedesk.com"],
 "ThingLink": ["thinglink.com"],
 "Think Realtime": ["esm1.net", "echosearch.com", "thinkrealtime.com"],
 "Thismoment": ["thismoment.com"],
 "Thummit": ["thummit.com"],
 "Tinder": ["tinder.com", "carbonads.com"],
 "TiqIQ": ["tiqiq.com"],
 "Todacell": ["todacell.com"],
 "ToneFuse": ["tonefuse.com"],
 "ToneMedia": ["clickfuse.com", "tonemedia.com"],
 "Topsy": ["topsy.com"],
 "TouchCommerce": ["inq.com", "touchcommerce.com"],
 "TraceMyIP.org": ["tracemyip.org"],
 "TrackingSoft": ["trackingsoft.com", "roia.biz"],
 "Trackset": ["trackset.com"],
 "TradeTracker": ["tradetracker.net", "tradetracker.com"],
 "Tradedoubler": ["tradedoubler.com"],
 "Tradespotting": ["tradespotting.com"],
 "TrafficHaus": ["traffichouse.com", "traffichaus.com"],
 "TrafficRevenue": ["trafficrevenue.net"],
 "Traffiq": ["traffiq.com"],
 "Travora Media": ["travoramedia.com",
                    "traveladvertising.com",
                    "traveladnetwork.com"],
 "Tremor Video": ["scanscout.com",
                   "tmnetads.com",
                   "tremormedia.com",
                   "tremorvideo.com"],
 "Triggit": ["triggit.com"],
 "Trovus": ["trovus.co.uk"],
 "TruEffect": ["adlegend.com", "trueffect.com"],
 "Trumba": ["trumba.com"],
 "TubeMogul": ["tmogul.com", "tubemogul.com"],
 "Tumblr": ["tumblr.com"],
 "Turn": ["turn.com"],
 "TurnTo": ["turnto.com", "turntonetworks.com"],
 "Tweetboard": ["tweetboard.com"],
 "Twelvefold": ["buzzlogic.com", "twelvefold.com"],
 "Twenga": ["twenga.it"],
 "Twitter": ["tweetdeck.com",
              "twitter.jp",
              "backtype.com",
              "crashlytics.com",
              "twimg.com",
              "twitter.com"],
 "Twitter Counter": ["twittercounter.com"],
 "Typography": ["typography.com"],
 "Tyroo": ["tyroo.com"],
 "USI Technologies": ["upsellit.com", "usitechnologies.com"],
 "UberMedia": ["ubermedia.com", "tweetup.com"],
 "UberTags": ["ubertags.com"],
 "Umbel": ["umbel.com"],
 "Unanimis": ["unanimis.co.uk"],
 "Unbounce": ["unbounce.com"],
 "Underdog Media": ["underdogmedia.com", "udmserve.net"],
 "Undertone": ["undertonenetworks.com",
                "undertonevideo.com",
                "undertone.com"],
 "UniQlick": ["uniqlick.com", "51network.com", "wanmo.com"],
 "Unruly": ["unrulymedia.com"],
 "Uptrends": ["uptrends.com"],
 "Usability Sciences": ["webiqonline.com", "usabilitysciences.com"],
 "User Local": ["nakanohito.jp"],
 "UserVoice": ["uservoice.com"],
 "VG WORT": ["vgwort.de"],
 "VINDICO": ["vindicogroup.com", "vindicosuite.com"],
 "VKontakte": ["vkontakte.ru", "vk.com", "userapi.com"],
 "ValueClick": ["dotomi.com",
                 "dtmpub.com",
                 "mediaplex.com",
                 "greystripe.com",
                 "valueclick.com",
                 "valueclick.net",
                 "emjcd.com",
                 "lduhtrp.net",
                 "fastclick.net",
                 "adserver.com",
                 "fastclick.com",
                 "valueclickmedia.com"],
 "Various": ["medley.com",
              "amigos.com",
              "nostringsattached.com",
              "various.com",
              "getiton.com"],
 "Vdopia": ["ivdopia.com", "vdopia.com"],
 "Velocity Media": ["adsvelocity.com"],
 "Velti": ["mobclix.com", "velti.com"],
 "Vemba": ["vemba.com"],
 "Vendio": ["singlefeed.com", "vendio.com"],
 "Veoxa": ["veoxa.com"],
 "Veremedia": ["veremedia.com"],
 "Vertical Acuity": ["verticalacuity.com"],
 "VerticalResponse": ["vresp.com", "verticalresponse.com"],
 "Vertster": ["vertster.com"],
 "Vibrant": ["vibrant.co"],
 "Vibrant Media": ["vibrantmedia.com", "intellitxt.com", "picadmedia.com"],
 "Videology": ["tidaltv.com", "videologygroup.com"],
 "Viewbix": ["qoof.com", "viewbix.com"],
 "VigLink": ["viglink.com"],
 "Vimeo": ["vimeocdn.com", "vimeo.com"],
 "Viralize": ["viralize.tv"],
 "VisiStat": ["visistat.com", "sa-as.com"],
 "Visible Measures": ["viewablemedia.net", "visiblemeasures.com"],
 "VisibleBrands": ["visbrands.com"],
 "Visit Streamer": ["visitstreamer.com"],
 "Visual Revenue": ["visualrevenue.com"],
 "VisualDNA": ["visualdna-stats.com", "vdna-assets.com", "visualdna.com"],
 "ViziSense": ["vizisense.com", "vizisense.net"],
 "Vizu": ["vizu.com"],
 "Vizury": ["vizury.com"],
 "Voice2Page": ["voice2page.com"],
 "Vserv": ["vserv.mobi", "vserv.com"],
 "WeatherChannel": ["weather.com"],
 "WOW Analytics": ["wowanalytics.co.uk"],
 "WPEngine": ["wpengine.com"],
 "WPP": ["mookie1.com",
          "themig.com",
          "acceleratorusa.com",
          "kantarmedia.com",
          "compete.com",
          "groupm.com",
          "pm14.com",
          "decdna.net",
          "mindshare.nl",
          "decideinteractive.com",
          "targ.ad",
          "realmedia.com",
          "accelerator-media.com",
          "wpp.com",
          "mecglobal.com",
          "gmads.net",
          "247realmedia.com",
          "xaxis.com"],
 "Wahoha": ["wahoha.com", "contentwidgets.net"],
 "Web Stats": ["onlinewebstats.com"],
 "Web Tracking Services": ["web-stat.com", "webtrackingservices.com"],
 "Web Traxs": ["webtraxs.com"],
 "Web·com": ["web.com", "feedperfect.com"],
 "WebAds": ["webads.co.uk"],
 "WebGozar·com": ["webgozar.com", "webgozar.ir"],
 "WebMetro": ["dsmmadvantage.com", "webmetro.com"],
 "Webclicktracker": ["webclicktracker.com"],
 "Weborama": ["weborama.fr", "weborama.com"],
 "WebsiteAlive": ["websitealive9.com",
                   "websitealive1.com",
                   "websitealive2.com",
                   "websitealive.com",
                   "websitealive6.com",
                   "websitealive8.com",
                   "websitealive4.com",
                   "websitealive7.com",
                   "websitealive5.com",
                   "websitealive3.com",
                   "websitealive0.com"],
 "Webtraffic": ["webtraffic.no", "webtraffic.se"],
 "Webtrekk": ["webtrekk.net", "webtrekk.com"],
 "Webtrends": ["webtrendslive.com", "webtrends.com", "reinvigorate.net"],
 "Wingify": ["visualwebsiteoptimizer.com", "wingify.com"],
 "WiredMinds": ["wiredminds.de", "wiredminds.com"],
 "Wirtualna Polska": ["adtotal.pl", "wp.pl"],
 "Woopra": ["woopra.com", "woopra-ns.com"],
 "WordPress": ["wp.com"],
 "WordStream": ["wordstream.com"],
 "Wysistat": ["wysistat.com"],
 "Xertive Media": ["admanager-xertive.com", "xertivemedia.com"],
 "Xrost DS": ["adplan-ds.com"],
 "Xtify": ["xtify.com"],
 "YD": ["ydworld.com", "yieldivision.com"],
 "YOC": ["yoc.com"],
 "Yabuka": ["yabuka.com"],
 "Yahoo!": ["dapper.net",
             "rightmedia.com",
             "adinterax.com",
             "yimg.com",
             "yahoofs.com",
             "secure-adserver.com",
             "ymail.com",
             "yieldmanager.net",
             "rmxads.com",
             "flickr.com",
             "interclick.com",
             "mybloglog.com",
             "rocketmail.com",
             "zenfs.com",
             "staticflickr.com",
             "yldmgrimg.net",
             "ypolicyblog.com",
             "thewheelof.com",
             "yuilibrary.com",
             "yieldmanager.com",
             "overture.com",
             "adrevolver.com",
             "yahooapis.com",
             "bluelithium.com",
             "yahoo."],
 "Yandex": ["moikrug.ru",
             "yandex.st",
             "yandex.ru",
             "yandex.com",
             "yandex.net",
             "yastatic.net",
             "web-visor.com",
             "yandex.by",
             "yandex.com.tr",
             "yandex.ua"],
 "Ybrant Digital": ["oridian.com",
                     "ybrantdigital.com",
                     "addynamix.com",
                     "adserverplus.com"],
 "YellowHammer": ["clickhype.com",
                   "yellowhammermg.com",
                   "attracto.com",
                   "yhmg.com"],
 "YellowTracker": ["yellowtracker.com"],
 "YieldAds": ["yieldads.com"],
 "YieldBuild": ["yieldbuild.com"],
 "Yieldlab": ["yieldlab.de", "yieldlab.net"],
 "YuMe": ["yume.com", "yumenetworks.com"],
 "ZEDO": ["zincx.com", "zedo.com"],
 "Zango": ["metricsdirect.com", "zango.com"],
 "Zemanta": ["zemanta.com"],
 "Zendesk": ["zendesk.com"],
 "ZestAd": ["zestad.com"],
 "Zeta Email Solutions": ["insightgrit.com", "zetaemailsolutions.com"],
 "Zodiak": ["mmondi.com"],
 "Zopim": ["zopim.com"],
 "Zumobi": ["zumobi.com"],
 "[x+1]": ["xplusone.com", "ru4.com"],
 "ad pepper media": ["adpepper.com", "adpepper.us"],
 "ad6media": ["ad6media.fr"],
 "adBrite": ["adbrite.com"],
 "adMarketplace": ["admarketplace.com"],
 "adPrecision": ["aprecision.net", "adprs.net"],
 "addGloo": ["addgloo.com"],
 "adhood": ["adhood.com"],
 "adnologies": ["adnologies.com", "heias.com"],
 "adrolays": ["adrolays.com", "adrolays.de"],
 "adscale": ["adscale.de"],
 "adyard": ["adyard.de"],
 "adzly": ["adzly.com"],
 "affilinet": ["successfultogether.co.uk",
                "banner-rotation.com",
                "affili.net",
                "affilinet-inside.de"],
 "anormal-media·de": ["anormal-media.de", "anormal-tracker.de"],
 "appssavvy": ["appssavvy.com"],
 "beencounter": ["beencounter.com"],
 "belboon": ["adbutler.de", "belboon.com"],
 "bigmir)net": ["bigmir.net"],
 "buySAFE": ["buysafe.com"],
 "cXense": ["cxense.com"],
 "comScore": ["certifica.com",
               "adxpose.com",
               "voicefive.com",
               "scorecardresearch.com",
               "comscore.com",
               "sitestat.com"],
 "dianomi": ["dianomi.com"],
 "dwstat·com": ["dwstat.cn"],
 "eBay": ["gopjn.com", "ebay.com"],
 "eProof.com": ["eproof.com"],
 "eTrigue": ["etrigue.com"],
 "eWayDirect": ["ixs1.net", "ewaydirect.com"],
 "eXTReMe digital": ["extreme-dm.com", "extremetracking.com"],
 "eXelate": ["exelator.com", "exelate.com"],
 "ekolay": ["ekolay.net", "e-kolay.net"],
 "engage:BDR": ["engagebdr.com", "bnmla.com"],
 "eTracker": ["etracker.com",
               "etracker.de",
               "sedotracker.de",
               "sedotracker.com"],
 "ewebse": ["777seo.com", "ewebse.com"],
 "excitad": ["excitad.com"],
 "expo-MAX": ["expo-max.com"],
 "eyeReturn Marketing": ["eyereturnmarketing.com", "eyereturn.com"],
 "faithadnet": ["faithadnet.com"],
 "iEntry": ["600z.com", "ientry.com"],
 "iPROM": ["iprom.net", "iprom.si", "centraliprom.com", "mediaiprom.com"],
 "iPerceptions": ["iperceptions.com"],
 "iPromote": ["ipromote.com"],
 "iProspect": ["iprospect.com", "clickmanage.com"],
 "imgIX": ["placehold.it", "imgix.net"],
 "inneractive": ["inner-active.com"],
 "iovation": ["iesnare.com", "iovation.com"],
 "isocket": ["isocket.com", "adsbyisocket.com"],
 "jsDelivr": ["jsdelivr.com"],
 "kikin": ["kikin.com"],
 "m6d": ["media6degrees.com", "m6d.com"],
 "madvertise": ["madvertise.com"],
 "mashero": ["mashero.com"],
 "media·net": ["media.net"],
 "mediaFORGE": ["mediaforge.com"],
 "motigo": ["motigo.com", "nedstatbasic.net"],
 "myThings": ["mythingsmedia.com", "mythings.com"],
 "newtention": ["newtention.net", "newtention.de", "newtentionassets.net"],
 "nrelate": ["nrelate.com"],
 "nugg·ad": ["nugg.ad", "nuggad.net"],
 "nurago": ["sensic.net", "nurago.de", "nurago.com"],
 "onAd": ["onad.eu"],
 "phpMyVisites": ["phpmyvisites.us"],
 "plista": ["plista.com"],
 "quadrantOne": ["quadrantone.com"],
 "reddit": ["reddit.com"],
 "sociomantic labs": ["sociomantic.com"],
 "sophus3": ["sophus3.co.uk", "sophus3.com"],
 "stat4u": ["4u.pl"],
 "teleSUR": ["telesurtv.net"],
 "twyn group": ["twyn.com"],
 "uCoz": ["ucoz."],
 "up-value": ["up-value.de"],
 "vistrac": ["vistrac.com"],
 "whos·amung·us": ["amung.us"],
 "xAd": ["xad.com"],
 "xplosion interactive": ["xplosion.de"],
 "youknowbest": ["youknowbest.com"],
 "zanox": ["buy.at", "zanox-affiliate.de", "zanox.com"],
 "zapunited": ["zaparena.com", "zapunited.com"],
 "ÖWA": ["oewabox.at", "oewa.at"]
};

var countryAttr = {
  "Google": "US",
  "HitsLink": "US",
  "IFlyChat": "US",
  "Cloudflare": "US",
  "AddThis": "US",
  "Facebook": "US",
  "Twitter": "US",
  "UserVoice": "US",
  "Amazon": "US",
  "Zendesk": "US",
  "media·net": "US",
  "Crazy Egg": "US",
  "WPP": "UK",
  "SpotXchange": "US",
  "WordPress": "US",
  "AOL": "US",
  "LinkedIn": "US",
  "Pinterest": "US",
  "AppNexus": "US",
  "Maxcdn": "US",
  "Automattic": "US",
  "comScore": "US",
  "Yandex": "RU",
  "Amazon AWS": "US",
  "LivePerson": "US",
  "INFOnline": "DE",
  "AT Internet": "US",
  "Histats": "IT",
  "Lotame": "US",
  "BlueKai": "US",
  "The Trade Desk": "US",
  "TubeMogul": "US",
  "Adform": "DK",
  "DataXu": "US",
  "Videology": "US",
  "MediaMath": "US",
  "Turn": "US",
  "Adobe": "US",
  "Bombora": "US",
  "ValueClick": "US",
  "Rocket Fuel": "US",
  "AudienceScience": "US",
  "RadiumOne": "US",
  "Tapad": "US",
  "Yahoo!": "US",
  "Zopim": "US",
  "Moat": "US",
  "Collective": "US",
  "Undertone": "US",
  "New Relic": "US",
  "ShareThis": "US",
  "AK": "US",
  "Cross Pixel": "US",
  "BrightTag": "US",
  "Datalogix": "US",
  "Neustar": "US",
  "Brightcove": "US",
  "Go Daddy": "US",
  "Quantcast": "US",
  "Disqus": "US",
  "Lockerz": "US",
  "StatCounter": "IE",
  "Olark": "US",
  "Evidon": "US",
  "zanox": "UK",
  "Cedexis": "FR",
  "Shareaholic": "US",
  "VigLink": "US",
  "OwnerIQ": "US",
  "Casale Media": "CA",
  "Bidswitch": "US",
  "CONTEXTWEB": "US",
  "OpenX": "US",
  "PubMatic": "IN",
  "Krux": "US",
  "eXelate": "US",
  "ADTECH": "US",
  "BrightRoll": "US",
  "Rapleaf": "US",
  "ADITION": "DE",
  "TRUSTe": "US",
  "AdSafe Media": "US",
  "Fox One Stop Media": "US",
  "Criteo": "FR",
  "Federated Media": "US",
  "eBay": "US",
  "Kataweb": "IT",
  "Nielsen": "US",
  "Webtrekk": "DE",
  "Chartbeat": "US",
  "Outbrain": "US",
  "DG": "US",
  "Elasticad": "US",
  "MaxCDN": "US",
  "Horyzon Media": "FR",
  "Optimizely": "US",
  "Microsoft": "US",
  "Yieldlab": "US",
  "RCS": "IT",
  "Gigya": "US",
  "MonoType": "US",
  "ShinyStat": "IT",
  "nugg·ad": "DE",
  "Apartena": "DE",
  "gator·IO": "US",
  "Webtrends": "US",
  "Gruner+Jahr": "DE",
  "Delta Projects": "SE",
  "SiteScout": "CA",
  "myThings": "UK",
  "Linkpulse": "NO",
  "Adex": "DE",
  "Zodiak": "IT",
  "Netmining": "US",
  "Zemanta": "US",
  "Improve Digital": "NL",
  "ClickTale": "US",
  "Onetag": "US",
  "Taboola": "US",
  "NeodataGroup": "IT",
  "Weborama": "FR",
  "WideOrbit": "US",
  "adscale": "DE",
  "I-Behavior": "US",
  "Higher One": "US",
  "CarrierZone": "US",
  "CacheFly": "US",
  "PhotoBucket": "US",
  "WeatherChannel": "US",
  "MarkMonitor": "US",
  "AdRiver": "RU",
  "Dot & Ads": "IT",
  "Browser-Update·org": "DE",
  "eTracker": "DE",
  "Publy": "FR",
  "Viralize": "IT",
  "Lottomatica": "IT",
  "Iubenda": "IT",
  "Banzai": "IT"
};

function initialize() {

    if(companyMap)
        return companyMap;

    /* use TLD to remove from here, so we can remove the third level domain too */
    companyMap = _.reduce(companySource, function(memo, listOfTrack, companyName) {
        _.each(listOfTrack, function(trackerDomain) {
            trackerStruct = tld.splitCName(trackerDomain);
            _.extend(trackerStruct, {
                'company': companyName
            });
            memo.push(trackerStruct)
        });
        return memo;
    }, []);
    return companyMap;
};

function countries(data) {
    data.data = _.map(data.data, function(inclusion) {
        if(inclusion.company)
            if(countryAttr[inclusion.company])
                inclusion.companyC = countryAttr[inclusion.company];
        return inclusion
    });
    return data;
};

function attribution(data) {
    
    initialize();

    debug("Processing site %s %d inclusions", data.page, _.size(data.data));
    data.data = _.map(data.data, function(inclusion) {

        tld.attribution(inclusion);
     
        var C = _.find(companyMap, function(c) {
            return _.startsWith(inclusion.domaindottld, c.domaindottld);
        });

        if(C)
            inclusion.company = C.company;

        return inclusion;
    });
    return data;
};

/* this process a `surface` and is a list */
function leaderCompanies(siteSummary) {

    var companiesRank = _.reduce(siteSummary, function(memo, ss) {
        _.each(ss.companies, function(cname) {
            if(_.isUndefined(memo[cname]))
                _.set(memo, cname, 0);
            memo[cname] += 1;
        });
        return memo;
    }, {});

    console.log(JSON.stringify(companiesRank, undefined, 2));

    var total = _.size(siteSummary);

    return _.map(siteSummary, function(ss) {
        var leaders = [];
        _.each(ss.companies, function(cname) {
            var presence = {
                company: cname,
                country: (countryAttr[cname]) ? countryAttr[cname] : "UNKNOW",
                p: _.round( (100 / total) * companiesRank[cname], 2)
            };
            leaders.push(presence);
        });
        ss.leaders = _.reverse(_.orderBy(leaders, 'p'));
        return ss;
    });
};

module.exports = {
    attribution: attribution,
    countries: countries,
    leaderCompanies: leaderCompanies
}
